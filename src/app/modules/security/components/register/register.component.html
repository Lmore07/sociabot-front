<div class="body">
  @if (spinnerStatus) {
  <loading></loading>
  }
  <p-toast key="informationToast"></p-toast>
  <div class="container">
    <div class="forms">
      <div class="form login">
        <div class="img-titulo">
          <span class="title">Registro de Usuario</span>
        </div>
        <div>
          <form [formGroup]="signUpFormGroup">
            <div class="container-names">
              <!-- NOMBRE -->
              <div class="field-container">
                <mat-form-field appearance="fill" class="mat-form-field">
                  <input
                    formControlName="first_name"
                    class="input"
                    maxlength="50"
                    [pKeyFilter]="allowLetters"
                    type="text"
                    matInput
                    placeholder="Nombre"
                  />
                  <mat-icon
                    matIconPrefix
                    svgIcon="iconLetter"
                    aria-hidden="false"
                  ></mat-icon>
                  <mat-hint>Ingrese su nombre</mat-hint>
                  @if (signUpFormGroup.get('first_name')?.hasError('required') &&
                  signUpFormGroup.get('first_name')?.touched) {
                  <mat-error>¡Este campo es requerido!</mat-error>
                  }@if (signUpFormGroup.get('first_name')?.hasError('pattern') &&
                  signUpFormGroup.get('first_name')?.touched) {
                  <mat-error>¡Ingrese un nombre válido!</mat-error>
                  }
                </mat-form-field>
              </div>
              <!-- APELLIDO -->
              <div class="field-container">
                <mat-form-field appearance="fill" class="mat-form-field">
                  <input
                    formControlName="last_name"
                    class="input"
                    [pKeyFilter]="allowLetters"
                    type="text"
                    maxlength="50"
                    matInput
                    placeholder="Apellido"
                  />
                  <mat-icon
                    matIconPrefix
                    svgIcon="iconLetter"
                    aria-hidden="false"
                  ></mat-icon>
                  <mat-hint>Ingrese su apellido</mat-hint>
                  @if (signUpFormGroup.get('last_name')?.hasError('required') &&
                  signUpFormGroup.get('last_name')?.touched) {
                  <mat-error>¡Este campo es requerido!</mat-error>
                  } @if (signUpFormGroup.get('last_name')?.hasError('pattern') &&
                  signUpFormGroup.get('last_name')?.touched) {
                  <mat-error>¡Ingrese un apellido válido!</mat-error>
                  }
                </mat-form-field>
              </div>
            </div>
            <div class="container-names">
              <!-- ROL -->
              <div class="field-container">
                <mat-form-field
                  hideRequiredMarker
                  appearance="fill"
                  class="mat-form-field"
                >
                  <mat-label>Rol dentro del colegio</mat-label>
                  <mat-select formControlName="role">
                    <mat-option value="STUDENT">Estudiante</mat-option>
                    <mat-option value="TEACHER">Profesor</mat-option>
                  </mat-select>
                  <mat-icon
                    matIconPrefix
                    svgIcon="iconRole"
                    aria-hidden="false"
                  ></mat-icon>
                  <mat-hint>Elija su rol</mat-hint>
                  @if (signUpFormGroup.get('role')?.hasError('required') &&
                  signUpFormGroup.get('role')?.touched) {
                  <mat-error>¡Este campo es requerido!</mat-error>
                  }
                </mat-form-field>
              </div>
              <!-- FECHA DE NACIMIENTO -->
              <div class="field-container">
                <mat-form-field appearance="fill" class="mat-form-field">
                  <input
                    [matDatepicker]="picker"
                    [min]="minDate"
                    [max]="maxDate"
                    formControlName="birth_date"
                    class="input"
                    matInput
                    placeholder="Fecha de Nacimiento"
                  />
                  <mat-datepicker-toggle
                    matIconSuffix
                    [for]="picker"
                  ></mat-datepicker-toggle>
                  <mat-datepicker touchUi #picker></mat-datepicker>
                  <mat-icon
                    matIconPrefix
                    svgIcon="iconCake"
                    aria-hidden="false"
                  ></mat-icon>
                  <mat-hint>Ingrese su fecha de nacimiento</mat-hint>
                  @if (signUpFormGroup.get('birth_date')?.hasError('required') &&
                  signUpFormGroup.get('birth_date')?.touched) {
                  <mat-error>¡Este campo es requerido!</mat-error>
                  }@if (signUpFormGroup.get('birth_date')?.hasError('dateRange')
                  && signUpFormGroup.get('birth_date')?.touched) {
                  <mat-error>
                    {{ signUpFormGroup.get('birth_date')?.errors?.['dateRange'].message }}
                  </mat-error>
                  }
                </mat-form-field>
              </div>
            </div>

            <!-- GENERO -->
            <div class="field-container">
              <mat-form-field
                hideRequiredMarker
                appearance="fill"
                class="mat-form-field"
              >
                <mat-label>Género</mat-label>
                <mat-select formControlName="gender">
                  <mat-option value="MALE">Masculino</mat-option>
                  <mat-option value="FEMALE">Femenino</mat-option>
                </mat-select>
                <mat-icon
                  matIconPrefix
                  svgIcon="iconRole"
                  aria-hidden="false"
                ></mat-icon>
                <mat-hint>Elija su género</mat-hint>
                @if (signUpFormGroup.get('gender')?.hasError('required') &&
                signUpFormGroup.get('gender')?.touched) {
                <mat-error>¡Este campo es requerido!</mat-error>
                }
              </mat-form-field>
            </div>
            <!-- CORREO ELECTRONICO -->
            <div class="field-container">
              <mat-form-field appearance="fill" class="mat-form-field">
                <input
                  formControlName="email"
                  class="input"
                  maxlength="100"
                  type="email"
                  matInput
                  placeholder="Correo Electrónico"
                />
                <mat-icon
                  matIconPrefix
                  svgIcon="iconMail"
                  aria-hidden="false"
                ></mat-icon>
                <mat-hint>Ingrese su correo electrónico</mat-hint>
                @if (signUpFormGroup.get('email')?.hasError('required') &&
                signUpFormGroup.get('email')?.touched) {
                <mat-error>¡Este campo es requerido!</mat-error>
                }@if (signUpFormGroup.get('email')?.hasError('pattern') &&
                signUpFormGroup.get('email')?.touched) {
                <mat-error
                  >¡El campo no coincide con un formato de correo
                  válido!</mat-error
                >
                }
              </mat-form-field>
            </div>
            <!-- CONTRASEÑA -->
            <div class="field-container">
              <mat-form-field appearance="fill" class="mat-form-field">
                <mat-icon matIconPrefix svgIcon="iconLock"></mat-icon>
                <input
                  [type]="hide ? 'password' : 'text'"
                  class="input"
                  maxlength="20"
                  matInput
                  formControlName="password"
                  placeholder="Contraseña"
                />
                <button
                  mat-icon-button
                  matSuffix
                  (click)="hide = !hide"
                  [attr.aria-pressed]="hide"
                >
                  <mat-icon
                    [svgIcon]="hide ? 'iconEyeOff' : 'iconEyeOn'"
                  ></mat-icon>
                </button>
                <mat-hint>Ingrese su contraseña</mat-hint>
                @if (signUpFormGroup.get('password')?.hasError('required') &&
                signUpFormGroup.get('password')?.touched) {
                <mat-error>¡La contraseña es requerida!</mat-error>
                } @if (signUpFormGroup.get('password')?.hasError('pattern') &&
                signUpFormGroup.get('password')?.touched) {
                <mat-error
                  >¡La contraseña no tiene el formato correcto!</mat-error
                >
                }
              </mat-form-field>
            </div>
            <div class="input-field button">
              <input
                (click)="callSignUpService()"
                type="submit"
                value="Registrate"
              />
            </div>
          </form>
        </div>

        <div class="login-signup">
          <span class="text"
            >Ya estás registrado?
            <a routerLink="/login" class="text signup-link">Inicia Sesión </a>
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
